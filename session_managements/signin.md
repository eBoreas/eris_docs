# ユーザのログイン機能

## 概要
ユーザがアプリケーションにログインするための機能

## 背景／目的
- ユーザが個別のアカウントを使用してアプリケーションにアクセスできるようにする
- セキュリティと個人設定のために個々のユーザ識別を可能にする

## 仕様
- ユーザはメールアドレスとパスワードを使用してログインする
- ログインに成功するとミッション一覧画面へ推移する
- ログインに失敗するとエラーメッセージが表示される
- Sessionの有効期限は２週間

### ユーザの入力／操作
- メールアドレス: 必須、メール型のバリデーション
- パスワード: 必須、8-20文字、英大文字・英小文字・数字・記号それぞれ１文字以上
- 「ログイン」ボタンのタップ

### 入力／操作の結果
#### 成功
- ミッション一覧画面へ推移する

#### 失敗
- ログイン画面にエラーメッセージを表示

## 想定されるレスポンス
#### 成功
- 200 OK

#### 失敗
- 401 Unauthorized
- エラーメッセージ
    - "メールアドレスまたはパスワードが正しくありません"

## デザイン
- なし

## 実装詳細
- JWTとRedisを使用したSession管理
   - user_idとSessionの有効期限を持ったJWTを作成
   - そのJWTがaccess-tokenとなる
   - Redisには`{ access-token: uuid }`のレコードを作成

- ユーザ認証
   - 送られてきたaccess-tokenをデコード
   - Sessionの有効期限が切れていた場合、gem標準のメソッドで自動でエラーが吐かれる
   - デコードされたJWTからuuidを取り出し、`User.find_by!(uuid: uuid)`でユーザを特定


## 追加予定の関連機能
- ログインID（ユーザID）を使用したログイン
- ログイン試行回数制限を設ける
- アクセスがあるごとに、Sessionの有効期限を伸ばす

## 参考リンク
- なし
